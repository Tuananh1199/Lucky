<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L√¨ X√¨ Premium 2026 - B√≠nh Ng·ªç ƒê·∫°i C√°t</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --primary-red: #9e1b1b;
            --dark-red: #5a0a0a;
            --gold-gradient: linear-gradient(135deg, #bf953f, #fcf6ba, #b38728, #fbf5b7, #aa771c);
            --bg-gradient: radial-gradient(circle at center, #4a0404 0%, #1a0000 100%);
            --glass: rgba(255, 255, 255, 0.97);
            --shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Montserrat', sans-serif;
            background: var(--bg-gradient);
            min-height: 100vh;
            color: #333;
            padding: 20px;
            overflow-x: hidden;
            position: relative;
        }

        /* Hi·ªáu ·ª©ng m√†ng s∆∞∆°ng v√†ng nh·∫π ph√≠a sau */
        body::before {
            content: "";
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: url('https://www.transparenttextures.com/patterns/pinstriped-suit.png');
            opacity: 0.05;
            pointer-events: none;
            z-index: 1;
        }

        /* Container ch√≠nh */
        .container {
            max-width: 1000px;
            margin: 0 auto;
            position: relative;
            z-index: 2;
            animation: fadeIn 1.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 50px 20px;
            background: var(--glass);
            border-radius: 40px;
            border: 2px solid #bf953f;
            box-shadow: var(--shadow);
        }

        .header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 3.5em;
            font-weight: 900;
            background: var(--gold-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        .horse-icon {
            font-size: 5em;
            cursor: pointer;
            display: inline-block;
            filter: drop-shadow(0 10px 15px rgba(0,0,0,0.3));
            animation: float 4s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(-5deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }

        /* Kh·ªëi n·ªôi dung */
        .main-content {
            background: var(--glass);
            padding: 40px;
            border-radius: 40px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 50px;
        }

        .btn {
            padding: 15px 35px;
            border-radius: 50px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: none;
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }

        .btn-gold {
            background: var(--gold-gradient);
            color: var(--dark-red);
            box-shadow: 0 10px 20px rgba(179, 119, 28, 0.3);
        }

        .btn-gold:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 15px 30px rgba(179, 119, 28, 0.5);
        }

        /* L√¨ x√¨ cards */
        .cards-container {
            display: flex;
            justify-content: center;
            gap: 25px;
            flex-wrap: wrap;
            margin: 60px 0;
            perspective: 2000px;
        }

        .card {
            width: 160px;
            height: 240px;
            position: relative;
            cursor: pointer;
            transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            transform-style: preserve-3d;
        }

        /* Hi·ªáu ·ª©ng rung nh√® nh·∫π khi ch∆∞a l·∫≠t */
        .card:not(.flipped):hover {
            animation: shake 0.5s ease infinite;
        }

        @keyframes shake {
            0% { transform: rotate(0); }
            25% { transform: rotate(2deg); }
            75% { transform: rotate(-2deg); }
            100% { transform: rotate(0); }
        }

        .card.flipped { transform: rotateY(180deg); }

        .card-face {
            position: absolute;
            width: 100%; height: 100%;
            backface-visibility: hidden;
            border-radius: 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 3px solid #bf953f;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }

        .card-front {
            background: linear-gradient(145deg, var(--primary-red), var(--dark-red));
            overflow: hidden;
        }

        .card-front::after {
            content: "Á¶è";
            position: absolute;
            font-size: 10em;
            color: rgba(252, 246, 186, 0.1);
            font-family: serif;
        }

        .card-front .icon { font-size: 5em; z-index: 1; filter: drop-shadow(0 5px 10px rgba(0,0,0,0.5)); }

        .card-back {
            background: #fff;
            background-image: radial-gradient(circle, #fff 0%, #fff4e6 100%);
            transform: rotateY(180deg);
        }

        .card-amount {
            font-size: 1.6em;
            color: var(--primary-red);
            font-weight: 900;
            text-align: center;
            padding: 0 10px;
        }

        .result-display {
            text-align: center;
            margin: 40px 0;
            height: 80px;
        }

        .result-amount {
            font-family: 'Playfair Display', serif;
            font-size: 3.8em;
            font-weight: 900;
            background: var(--gold-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 5px 10px rgba(0,0,0,0.1));
        }

        /* Stats */
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-top: 50px;
        }

        .stat-card {
            background: #fff;
            padding: 25px;
            border-radius: 25px;
            text-align: center;
            border: 1px solid #f1f1f1;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
        }

        .stat-value { color: var(--primary-red); font-size: 1.8em; font-weight: 800; }
        .stat-label { color: #999; text-transform: uppercase; font-size: 0.8em; margin-top: 8px; font-weight: 600; }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left:0; top:0; width:100%; height:100%;
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(10px);
        }

        .modal-content {
            background: white;
            margin: 5vh auto;
            padding: 40px;
            border-radius: 40px;
            width: 90%; max-width: 600px;
            border: 4px solid #bf953f;
            position: relative;
        }

        .history-item {
            background: #fffdf9;
            padding: 18px 25px;
            margin: 12px 0;
            border-radius: 20px;
            border-left: 6px solid #bf953f;
            display: flex;
            justify-content: space-between;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        @media (max-width: 600px) {
            .header h1 { font-size: 2em; }
            .card { width: 140px; height: 210px; }
            .result-amount { font-size: 2.5em; }
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="header">
            <div class="horse-icon" onclick="handleHorseClick()">üê¥</div>
            <h1>B√≠nh Ng·ªç ƒê·∫°i C√°t</h1>
            <p style="color: #888; letter-spacing: 2px;">V·∫°n S·ª± Nh∆∞ √ù - ƒê·∫Øc L·ªôc Th√†nh C√¥ng</p>
        </div>

        <div class="main-content">
            <div class="controls">
                <button class="btn btn-gold" onclick="resetCards()">üé≤ Khai L·ªôc M·ªõi</button>
                <button class="btn" style="background: #f5f5f5; color: #999;" onclick="clearHistory()">üóëÔ∏è X√≥a L·ªãch S·ª≠</button>
            </div>

            <div class="cards-container" id="cardsContainer"></div>

            <div class="result-display">
                <div class="result-amount" id="resultAmount">Nh·∫≠n l·ªôc ƒë·∫ßu xu√¢n</div>
            </div>

            <div class="stats">
                <div class="stat-card">
                    <div class="stat-value" id="totalPicks">0</div>
                    <div class="stat-label">L∆∞·ª£t nh·∫≠n l·ªôc</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalAmount">0ƒë</div>
                    <div class="stat-label">T·ªïng ti·ªÅn l·ªôc</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="maxAmount">0ƒë</div>
                    <div class="stat-label">L·ªôc l·ªõn nh·∫•t</div>
                </div>
            </div>

            <div id="historyList"></div>
        </div>
    </div>

    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <span style="position:absolute; right:25px; top:20px; font-size:30px; cursor:pointer;" onclick="closeSettings()">&times;</span>
            <h2 style="color: var(--primary-red); font-family: 'Playfair Display', serif; margin-bottom: 30px; text-align: center;">‚öôÔ∏è C·∫•u H√¨nh H·ªá Th·ªëng</h2>
            
            <div id="passwordSection">
                <input type="password" id="passwordInput" placeholder="M·∫≠t kh·∫©u b√≠ m·∫≠t..." style="width:100%; padding:15px; border-radius:15px; border:1px solid #ddd; margin-bottom:15px;">
                <button class="btn btn-gold" style="width:100%" onclick="checkPassword()">X√°c nh·∫≠n</button>
            </div>

            <div id="settingsContent" style="display: none;">
                <div style="margin-bottom: 20px;">
                    <label style="font-weight: bold;">S·ªë l∆∞·ª£ng th·∫ª b√†i:</label>
                    <input type="number" id="numCards" value="5" min="3" max="10" style="width:100%; padding:10px; margin-top:10px;">
                </div>
                <div id="valuesList" style="max-height: 250px; overflow-y: auto; margin-bottom: 20px; padding:10px; border:1px solid #eee;"></div>
                <button class="btn" style="width:100%; background: #eee; margin-bottom:10px;" onclick="addValue()">+ Th√™m m·ªánh gi√°</button>
                <button class="btn btn-gold" style="width:100%" onclick="saveSettings()">üíæ L∆∞u C√†i ƒê·∫∑t</button>
            </div>
        </div>
    </div>

    <script>
        const PASSWORD = "Test@12345";
        let isAuthenticated = false;
        let horseClickCount = 0;
        let horseClickTimer = null;

        const PRESETS = {
            balanced: { values: [{ amount: 20000, probability: 30 }, { amount: 50000, probability: 30 }, { amount: 100000, probability: 25 }, { amount: 200000, probability: 10 }, { amount: 500000, probability: 5 }] }
        };

        // Kh·ªüi t·∫°o ph√°o hoa
        function fireCongrats(amount) {
            const duration = 3 * 1000;
            const end = Date.now() + duration;

            (function frame() {
                confetti({
                    particleCount: 5,
                    angle: 60,
                    spread: 55,
                    origin: { x: 0 },
                    colors: ['#bf953f', '#ff0000', '#ffffff']
                });
                confetti({
                    particleCount: 5,
                    angle: 120,
                    spread: 55,
                    origin: { x: 1 },
                    colors: ['#bf953f', '#ff0000', '#ffffff']
                });

                if (Date.now() < end) {
                    requestAnimationFrame(frame);
                }
            }());
        }

        function handleHorseClick() {
            horseClickCount++;
            clearTimeout(horseClickTimer);
            if (horseClickCount >= 3) { openSettings(); horseClickCount = 0; }
            horseClickTimer = setTimeout(() => { horseClickCount = 0; }, 800);
        }

        function loadSettings() {
            const saved = localStorage.getItem('lixi_v3_settings');
            return saved ? JSON.parse(saved) : { numCards: 5, values: PRESETS.balanced.values };
        }

        function openSettings() {
            document.getElementById('settingsModal').style.display = 'block';
            if (!isAuthenticated) {
                document.getElementById('passwordSection').style.display = 'block';
                document.getElementById('settingsContent').style.display = 'none';
            }
        }

        function checkPassword() {
            if (document.getElementById('passwordInput').value === PASSWORD) {
                isAuthenticated = true;
                document.getElementById('passwordSection').style.display = 'none';
                document.getElementById('settingsContent').style.display = 'block';
                renderValuesList(loadSettings().values);
            } else { alert('Sai m·∫≠t kh·∫©u!'); }
        }

        function renderValuesList(values) {
            const container = document.getElementById('valuesList');
            container.innerHTML = values.map((v, idx) => `
                <div style="display:flex; gap:10px; margin-bottom:10px;">
                    <input type="number" class="val-amt" value="${v.amount}" style="flex:2; padding:8px;">
                    <input type="number" class="val-prob" value="${v.probability}" style="flex:1; padding:8px;">
                    <button onclick="this.parentElement.remove()" style="border:none; background:none; color:red; cursor:pointer;">‚úï</button>
                </div>
            `).join('');
        }

        function addValue() {
            const div = document.createElement('div');
            div.style.cssText = "display:flex; gap:10px; margin-bottom:10px;";
            div.innerHTML = `<input type="number" class="val-amt" value="10000" style="flex:2; padding:8px;"><input type="number" class="val-prob" value="10" style="flex:1; padding:8px;"><button onclick="this.parentElement.remove()" style="border:none; background:none; color:red; cursor:pointer;">‚úï</button>`;
            document.getElementById('valuesList').appendChild(div);
        }

        function saveSettings() {
            const ampts = document.querySelectorAll('.val-amt');
            const probs = document.querySelectorAll('.val-prob');
            let newValues = [], totalP = 0;
            ampts.forEach((el, i) => {
                newValues.push({ amount: parseInt(el.value), probability: parseInt(probs[i].value) });
                totalP += parseInt(probs[i].value);
            });
            if (totalP !== 100) { alert('T·ªïng t·ª∑ l·ªá % ph·∫£i b·∫±ng 100!'); return; }
            localStorage.setItem('lixi_v3_settings', JSON.stringify({ numCards: parseInt(document.getElementById('numCards').value), values: newValues }));
            closeSettings(); resetCards();
        }

        function closeSettings() { document.getElementById('settingsModal').style.display = 'none'; }

        function formatMoney(n) { return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".") + "ƒë"; }

        function getRandomAmount() {
            const settings = loadSettings();
            const rand = Math.random() * 100;
            let cumulative = 0;
            for (const v of settings.values) {
                cumulative += v.probability;
                if (rand <= cumulative) return v.amount;
            }
            return settings.values[0].amount;
        }

        function createCards() {
            const settings = loadSettings();
            const container = document.getElementById('cardsContainer');
            container.innerHTML = '';
            for (let i = 0; i < settings.numCards; i++) {
                const amt = getRandomAmount();
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `<div class="card-face card-front"><div class="icon">üê¥</div></div>
                                  <div class="card-face card-back">
                                      <div style="font-size:2.5em; margin-bottom:10px;">üßß</div>
                                      <div class="card-amount">${formatMoney(amt)}</div>
                                  </div>`;
                card.onclick = () => flipCard(card, amt);
                container.appendChild(card);
            }
        }

        function flipCard(el, amt) {
            if (el.classList.contains('flipped')) return;
            el.classList.add('flipped');
            
            // Hi·ªáu ·ª©ng ph√°o hoa khi nh·∫≠n l·ªôc l·ªõn (> 100k)
            if (amt >= 100000) {
                fireCongrats(amt);
            } else {
                confetti({ particleCount: 50, spread: 60, origin: { y: 0.7 } });
            }

            document.getElementById('resultAmount').textContent = formatMoney(amt);
            saveToHistory(amt);
            updateStats();
        }

        function resetCards() {
            const container = document.getElementById('cardsContainer');
            container.style.opacity = '0';
            container.style.transform = 'scale(0.9)';
            setTimeout(() => {
                createCards();
                container.style.opacity = '1';
                container.style.transform = 'scale(1)';
                document.getElementById('resultAmount').textContent = 'Nh·∫≠n l·ªôc ƒë·∫ßu xu√¢n';
            }, 400);
        }

        function saveToHistory(amount) {
            const history = JSON.parse(localStorage.getItem('lixi_v3_history')) || [];
            history.unshift({ amount, time: new Date().toLocaleTimeString('vi-VN') });
            localStorage.setItem('lixi_v3_history', JSON.stringify(history.slice(0, 10)));
            displayHistory();
        }

        function displayHistory() {
            const history = JSON.parse(localStorage.getItem('lixi_v3_history')) || [];
            const container = document.getElementById('historyList');
            if (history.length === 0) { container.innerHTML = ''; return; }
            container.innerHTML = '<h3 style="margin: 40px 0 15px; color:var(--primary-red); text-align:center;">üìú Danh S√°ch Nh·∫≠n L·ªôc</h3>' + 
                history.map(h => `<div class="history-item"><span style="font-weight:700; color:var(--primary-red);">${formatMoney(h.amount)}</span><span style="color:#999; font-size:0.8em">${h.time}</span></div>`).join('');
        }

        function updateStats() {
            const history = JSON.parse(localStorage.getItem('lixi_v3_history')) || [];
            if (history.length === 0) return;
            const amounts = history.map(h => h.amount);
            document.getElementById('totalPicks').textContent = history.length;
            document.getElementById('totalAmount').textContent = formatMoney(amounts.reduce((a, b) => a + b, 0));
            document.getElementById('maxAmount').textContent = formatMoney(Math.max(...amounts));
        }

        function clearHistory() {
            if (confirm('B·∫°n mu·ªën x√≥a l·ªãch s·ª≠ nh·∫≠n l·ªôc?')) {
                localStorage.removeItem('lixi_v3_history');
                displayHistory(); 
                document.getElementById('totalPicks').textContent = '0';
                document.getElementById('totalAmount').textContent = '0ƒë';
                document.getElementById('maxAmount').textContent = '0ƒë';
            }
        }

        window.onload = () => { 
            createCards(); 
            displayHistory(); 
            updateStats();
            // Hi·ªáu ·ª©ng r∆°i ti·ªÅn nh·∫π khi v√†o trang
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 }, colors: ['#bf953f', '#ffffff'] });
        };
        
        window.onclick = (e) => { if (e.target.className === 'modal') closeSettings(); };
    </script>
</body>
</html>
